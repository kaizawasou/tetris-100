#!/usr/bin/env bash
set -euo pipefail
TS="$(date '+%Y%m%d_%H%M%S')"
ROOT="$(cd "$(dirname "$0")/.." && pwd)"
OUT="$ROOT/ops/logs/precommit_quality_gate_${TS}.txt"
QG="$ROOT/scripts/quality_gate_min.sh"

if [ ! -x "$QG" ]; then
  echo "[pre-commit] ERROR: quality gate not executable: $QG" | tee -a "$OUT" >/dev/null
  exit 1
fi

"$QG" "$OUT"
echo "[pre-commit] quality gate passed: $OUT"
